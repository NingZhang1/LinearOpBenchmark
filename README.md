<style type="text/css">
    h1 { counter-reset: h2counter; }
    h2 { counter-reset: h3counter; }
    h3 { counter-reset: h4counter; }
    h4 { counter-reset: h5counter; }
    h5 { counter-reset: h6counter; }
    h6 { }
    h2:before {
      counter-increment: h2counter;
      content: counter(h2counter) ".\0000a0\0000a0";
    }
    h3:before {
      counter-increment: h3counter;
      content: counter(h2counter) "."
                counter(h3counter) ".\0000a0\0000a0";
    }
    h4:before {
      counter-increment: h4counter;
      content: counter(h2counter) "."
                counter(h3counter) "."
                counter(h4counter) ".\0000a0\0000a0";
    }
    h5:before {
      counter-increment: h5counter;
      content: counter(h2counter) "."
                counter(h3counter) "."
                counter(h4counter) "."
                counter(h5counter) ".\0000a0\0000a0";
    }
    h6:before {
      counter-increment: h6counter;
      content: counter(h2counter) "."
                counter(h3counter) "."
                counter(h4counter) "."
                counter(h5counter) "."
                counter(h6counter) ".\0000a0\0000a0";
    }
</style>

# Benchmark on Linear Algebra Operations 

这个仓库用于测试不同实现线性代数操作的性能，不同的实现方案包括

1. 手写 C++ 代码 (plain C++)
2. MKL
3. Eigen
4. ISPC
5. 模板循环展开  

## 缓存的影响

下面表格展现了两种测试 ddot 速度的方法，分别见:

* Benchmark/LinearOp/blas1-04-ddot.cpp
* Benchmark/LinearOp/blas1-06-ddot2.cpp
  
| BatchSize | Plain C++ |        |       | Eigen  |        |       | ISPC   |        |       | MKL    |        |        |
|-----------|-----------|--------|-------|--------|--------|-------|--------|--------|-------|--------|--------|--------|
|           | ddot      | ddot2  | Rela  | ddot   | ddot2  | Rela  | ddot   | ddot2  | Rela  | ddot   | ddot2  | Rela   |
| 4         | 1.412     | 2.019  | 1.43  | 2.810  | 3.107  | 1.11  | 0.966  | 1.299  | 1.34  | 0.362  | 0.706  | 1.95   |
| 8         | 2.021     | 2.700  | 1.34  | 3.613  | 3.667  | 1.01  | 2.784  | 3.929  | 1.41  | 0.830  | 1.602  | 1.93   |
| 16        | 2.839     | 3.091  | 1.09  | 5.014  | 3.920  | 0.78  | 4.870  | 3.700  | 0.76  | 1.266  | 2.607  | 2.06   |
| 32        | 2.323     | 2.701  | 1.16  | 6.293  | 3.973  | 0.63  | 7.064  | 4.167  | 0.59  | 2.293  | 3.821  | 1.67   |
| 64        | 1.806     | 2.649  | 1.47  | 5.899  | 3.913  | 0.66  | 6.375  | 4.446  | 0.70  | 3.049  | 4.429  | 1.45   |
| 128       | 1.591     | 2.392  | 1.50  | 5.015  | 3.982  | 0.79  | 8.134  | 4.308  | 0.53  | 4.126  | 4.330  | 1.05   |
| 256       | 1.226     | 2.104  | 1.72  | 4.724  | 4.266  | 0.90  | 8.025  | 4.465  | 0.56  | 4.836  | 4.421  | 0.91   |
| 512       | 1.180     | 1.958  | 1.66  | 4.631  | 4.350  | 0.94  | 7.425  | 4.663  | 0.63  | 4.862  | 4.077  | 0.84   |
| 1024      | 1.128     | 1.965  | 1.74  | 4.504  | 4.729  | 1.05  | 7.832  | 4.467  | 0.57  | 4.457  | 3.731  | 0.84   |
| 2048      | 1.110     | 1.969  | 1.77  | 4.397  | 4.594  | 1.04  | 6.958  | 4.514  | 0.65  | 5.604  | 3.821  | 0.68   |
| 4096      | 1.072     | 2.012  | 1.88  | 4.309  | 4.156  | 0.96  | 6.275  | 4.323  | 0.69  | 5.727  | 3.795  | 0.66   |
| 8192      | 1.120     | 2.010  | 1.79  | 4.115  | 4.302  | 1.05  | 6.343  | 4.718  | 0.74  | 5.517  | 3.658  | 0.66   |
| 16384     | 1.113     | 1.983  | 1.78  | 4.100  | 4.010  | 0.98  | 6.131  | 4.292  | 0.70  | 5.007  | 3.728  | 0.74   |
| 32768     | 1.085     | 1.975  | 1.82  | 3.391  | 4.490  | 1.32  | 5.990  | 4.584  | 0.77  | 4.358  | 3.996  | 0.92   |
| 65536     | 1.102     | 1.950  | 1.77  | 4.245  | 4.601  | 1.08  | 4.205  | 4.372  | 1.04  | 3.980  | 3.877  | 0.97   |
| 131072    | 1.100     | 1.987  | 1.81  | 4.255  | 4.820  | 1.13  | 4.567  | 4.682  | 1.03  | 4.385  | 3.902  | 0.89   |
| 262144    | 1.086     | 1.972  | 1.82  | 4.161  | 4.762  | 1.14  | 4.787  | 4.551  | 0.95  | 3.476  | 4.009  | 1.15   |
| 524288    | 1.086     | 1.990  | 1.83  | 3.418  | 4.302  | 1.26  | 4.396  | 4.723  | 1.07  | 3.247  | 4.164  | 1.28   |
| 1048576   | 1.088     | 1.970  | 1.81  | 2.905  | 4.575  | 1.57  | 2.963  | 4.536  | 1.53  | 2.688  | 3.911  | 1.45   |
| 2097152   | 1.042     | 1.959  | 1.88  | 2.429  | 3.929  | 1.62  | 2.642  | 4.484  | 1.70  | 2.225  | 3.774  | 1.70   |
| 4194304   | 1.017     | 1.981  | 1.95  | 2.127  | 4.516  | 2.12  | 2.409  | 4.610  | 1.91  | 2.346  | 3.784  | 1.61   |
| 8388608   | 0.886     | 2.000  | 2.26  | 1.794  | 4.840  | 2.70  | 2.229  | 4.169  | 1.87  | 2.181  | 3.823  | 1.75   |
| 16777216  | 1.042     | 1.984  | 1.90  | 2.273  | 4.626  | 2.04  | 1.918  | 4.428  | 2.31  | 2.294  | 3.723  | 1.62   |
| 33554432  | 1.013     | 1.979  | 1.95  | 2.458  | 4.639  | 1.89  | 1.983  | 4.685  | 2.36  | 1.990  | 3.824  | 1.92   |

![MyPic] ./Benchmark/Result/CacheISPC.png